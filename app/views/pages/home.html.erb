<!-- Render banner and modal -->
<%= render 'shared/home_banner' %>
<!-- Homepage contents -->
<div class="container mt-3">
  <div>
    <div class="row" style="position: relative;">
      <div class="col-9">
        <h4 class="mb-1">Top Rated</h4>
      </div>
      <div class="col">
        <%=  link_to (product_path(0) + '?sort_by=top_rated') do %>
          <span class="mb-1 text-right mr-3" style="position: absolute; bottom:0; right:0;">More<i class="fas fa-chevron-right"></i></span>
        <% end %>
      </div>
    </div>
    <div class="row mx-0 mb-3">
      <% @top_rated_products.each do |product| %>
        <div class="col-6 col-md-4 col-lg-2 p-0 m-0">
          <% bg_img_url = product.photo.attached? ? cl_image_path(product.photo.key) : image_path("default-product.png") %>
          <%= link_to product_path(product) do %>
            <% avg_rating = product.avg_rating %>
            <%= render 'shared/product_card', bg_img_url: bg_img_url, product_name: product.name, price: "⭐#{avg_rating ? avg_rating.round(1) : '-'} (#{product.reviews.count})" %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
  <div>
    <div class="row" style="position: relative;">
      <div class="col-9">
        <h4 class="mt-3 mb-1">Most Favorited</h4>
      </div>
      <div class="col">
        <%=  link_to (product_path(0) + '?sort_by=most_favorited') do %>
          <span class="mb-1 text-right mr-3" style="position: absolute; bottom:0; right:0;">More<i class="fas fa-chevron-right"></i></span>
        <% end %>
      </div>
    </div>
    <div class="row mx-0 mb-3">
      <% @most_favorited_products.each do |product| %>
        <div class="col-6 col-md-4 col-lg-2 p-0 m-0">
          <% bg_img_url = product.photo.attached? ? cl_image_path(product.photo.key) : image_path("default-product.png") %>
          <%= link_to product_path(product) do %>
            <% avg_rating = product.avg_rating %>
            <%= render 'shared/product_card', bg_img_url: bg_img_url, product_name: product.name, price: "⭐#{avg_rating ? avg_rating.round(1) : '-'} (#{product.reviews.count})" %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
<!-- Render footer -->
<%= render 'shared/home_footer' %>
<%= render 'shared/footer' %>
